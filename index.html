<div class="card">
  <h3>Gestion des signaux</h3>
  <p>4 signaux toutes les 4 heures</p>
  <button class="btn" onclick="adminSignal()">G√©n√©rer signal</button>
  <div id="adminSignalMsg" class="notice"></div>
</div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let lastSignal = 0;

function show(id){
  document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

function signup(){
  alert("Compte cr√©√© (d√©mo)");
  show("login");
}

function signup(){
  const u = prompt("Entrez votre nom d'utilisateur:");
  const p = prompt("Entrez un mot de passe:");
  if(!u || !p){
    alert("Nom d'utilisateur ou mot de passe invalide");
    return;
  }
  if(users[u]){
    alert("Utilisateur d√©j√† existant");
    return;
  }
  users[u] = {pass:p, balance:0, code:"USR"+(Object.keys(users).length+1).toString().padStart(3,'0')};
  alert("Compte cr√©√© avec succ√®s !");
  show("login"); // redirige vers le login
}

function getSignal(){
  const now=Date.now();
  if(now-lastSignal<4*60*60*1000){
    document.getElementById("signalMsg").innerText="‚è≥ Signal indisponible ‚Äì prochain dans 4h";
  }else{
    lastSignal=now;
    document.getElementById("signalMsg").innerText="üìà Signal g√©n√©r√© ‚Äì march√© simul√©";
  }
}
// --- MISE √Ä JOUR DU DASHBOARD ---
function update(){
  if(!current) return;

  // Met √† jour le solde
  balance.innerText = users[current].balance.toFixed(2) + " USDT";

  // Met √† jour les infos compte
  accUser.innerText = current;
  myCode.innerText = users[current].code;

  // Afficher bouton Admin uniquement si c'est admin
  if(current === "admin"){ 
      document.getElementById("btnAdmin").style.display = "inline-block"; 
  } else { 
      document.getElementById("btnAdmin").style.display = "none"; 
  }
  }
// --- GRAPH TRADINGVIEW SIMUL√â ---
const ctx = document.getElementById('tradingChart').getContext('2d');
new Chart(ctx, {
    type: 'line', // visuel pro
    data: {
        labels: ['09h','10h','11h','12h','13h','14h','15h'],
        datasets: [{
            label: 'USD/USDT',
            data: [100,102,106,105,110,113,116],
            borderColor: '#ff9800',
            backgroundColor: '#2563eb',
            fill: true
        }]
    },
    options: {
        responsive:true,
        plugins:{legend:{display:false}},
        scales:{
            x:{grid:{color:'#1e293b'}},
            y:{grid:{color:'#1e293b'}}
        }
    }
});
// --- ADMIN ---
function showAdmin(){
 if(current === "admin"){ 
    show("admin"); 
 } else { 
    alert("Acc√®s interdit : r√©serv√© √† l‚Äôadministrateur"); 
 }
}

// --- ENVOI SOLDE ---
function sendBalance(){
 const uid = adminUID.value;
 const amount = parseFloat(adminAmount.value);

 if(!users[uid]){
   adminMsg.innerText="Utilisateur introuvable"; 
   return;
 }

 if(isNaN(amount) || amount <= 0){
   adminMsg.innerText="Montant invalide"; 
   return;
 }

 if(!confirm(`Confirmer l‚Äôenvoi de ${amount.toFixed(2)} USDT √† ${uid} ?`)){
   adminMsg.innerText="Envoi annul√©"; 
   return;
 }

 users[uid].balance += amount;
 adminMsg.innerText=`‚úÖ ${amount.toFixed(2)} USDT envoy√© √† ${uid}`;
 notify(`Admin a cr√©dit√© ${amount.toFixed(2)} USDT √† ${uid}`);
 update(); // Met √† jour le dashboard
}

// --- ADMIN SIGNAL ---
function adminSignal(){
 const gain = (Math.random()*10-5);
 notify(`Signal Admin g√©n√©r√©: ${gain.toFixed(2)} USDT`);
 adminSignalMsg.innerText=`Signal g√©n√©r√©: ${gain.toFixed(2)} USDT`;
 lastSignal = Date.now(); // reset le signal pour tout le monde
      }</script>

</body>
</html>
